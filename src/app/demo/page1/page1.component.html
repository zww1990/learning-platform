<nz-upload nzType="drag" [nzAccept]="accepts.toString()" [nzBeforeUpload]="beforeUpload">
  <p class="ant-upload-drag-icon">
    <i class="anticon anticon-inbox"></i>
  </p>
  <p class="ant-upload-text">点击或拖动文件到这个区域上传</p>
  <p class="ant-upload-hint">将文件拖到此处，或点击上传只能上传xls/xlsx文件</p>
</nz-upload>
<ng-template [ngIf]="tables.length!==0">
  <div class="table-operations">
    <button nz-button (click)="exportExcel()">导出Excel文件</button>
  </div>
  <nz-tabset [nzTabPosition]="'bottom'">
    <nz-tab *ngFor="let table of tables">
      <ng-template #nzTabHeading>{{table.name}}</ng-template>
      <nz-table #nzTable [nzDataSource]="table.data" [nzPageSize]="10" [nzShowTotal]="true">
        <thead nz-thead>
          <tr>
            <th nz-th *ngFor="let item of table.header">
              <span>{{item}}</span>
            </th>
          </tr>
        </thead>
        <tbody nz-tbody>
          <tr nz-tbody-tr *ngFor="let data of nzTable.data">
            <td nz-td *ngFor="let item of table.header">{{data[item]}}</td>
          </tr>
        </tbody>
      </nz-table>
    </nz-tab>
  </nz-tabset>
</ng-template>
